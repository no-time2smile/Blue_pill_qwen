Сделай схему и разводку печатной платы под Dip Trace для такого девайса:

1. Я не хочу распаивать процессор и его обвязку, поэтому используем плату, называемую на жаргоне электронщиков "Blue Pill" или "Пилюля", вот она -  https://sl.aliexpress.ru/p?key=LlNw3nB, её впаиваем прямо в плату как модуль.
2. Будет задействовано в STM32F103 на вход 2 таймера в режиме счёта квадратурных (энкодерных) импульсов и на выход 2 таймера в режиме генерации сигналов STEP/DIR. Надо проверить, какие таймеры для этого годятся.
3. Таймерные входы через AM26LV32 / H11L1 H11L1 (DIP) (предусмотреть варианты сборки, т.е. площадки под оба варианта, а впаивать будем только что-то одно). У оптопар выводить оба конца светодиода, не заземлять входы, последовательно резистор 2К.
4. Таймерные выходы - через AM26LS31 или ULN2003 с подтяжкой 1K к 5V (варианты). Питание 3,3в берём с пилюли.
5. будут порты RS-485 ( MAX485) и RS-232 (MAX3232) 
6. 2 слоя платы, все компоненты, кроме отмеченных  (DIP), какие можно - SMD резисторы/конденсаторы 0805 
7. Впаиваем готовый модуль XL1509 с обвязкой (24V>5V) на вход питания 5в. https://sl.aliexpress.ru/p?key=QwZZ3Mw
8. все входы/выходы, включая питание через такие клеммники (3,5мм шаг) https://sl.aliexpress.ru/p?key=mawZ3POhttps://sl.aliexpress.ru/p?key=mawZ3PO
9. Светодиод PWR 5v
10. На плате подписи: ENC1_A, ENC1_B, ENC1_IDX (аналогично для ENC2)
   Диф.выходы: STEP1+, STEP1-, DIR1+, DIR1-
11. 4 оставшихся GPIO через ULN2003 на выход + 1 GND на клеммниках 3.5mm 
12. 4 оставшихся GPIO через PC817 (DIP) на вход + 1 GND на клеммниках 3.5mm 
13. Светодиоды LED1-LED3 на свободные GPIO, если их на Пилюле не хватает на всё, скажи мне, я решу, что делать. 
14. 4 крепёжных отверстия (диаметр 3 мм).
 Две пары с межцентровым 25 мм, расположены по краям платы.
 Расстояние между парами — по габаритам платы.
15. порядок проектирования - сначала схема принципиальная, отправляешь на утверждение, если всё ок - разводка платы, BOM.

Что ещё осталось уточнить?